@page "/account-details/{id:int}"
@using AllowanceApp.Blazor.Components.Pages
@using AllowanceApp.Blazor.Services
@using AllowanceApp.Shared.DTO
@inject AccountApiService AccountApi

@if (account is null)
{
    <p><em>Loading...</em></p>
}
else
{
    <PageTitle>@account.Name</PageTitle>
    <div class="grid grid-cols-2 gap-4 w-full max-w-6xl mx-auto">
        <div class="w-full max-add-sm"><AccountCard AccountRecord="@account" OnAccountChanged="@RefreshAccount"></AccountCard></div>
        <div class="w-50 max-add-sm"><BalanceCard AccountRecord="@account"></BalanceCard></div>
        <div class="col-span-full">
            <TransactionCard AccountRecord="@account"></TransactionCard>
        </div>
    </div>
}


@code {
    private AccountDTO? account;
    [Parameter] public int id {get; set;}

    protected override async Task OnInitializedAsync()
    {
        account = await AccountApi.GetAccountAsync(id);
    }
        protected override async Task OnParametersSetAsync()
    {
        account = await AccountApi.GetAccountAsync(id);
    }
    private void RefreshAccount()
    {
        StateHasChanged();
    }
}